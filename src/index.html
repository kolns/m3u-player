<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>m3u Player</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
  <script src="hls.min.js"></script>
  <script src="mpegts.min.js"></script>
  <script type="module" src="/main.js" defer></script>
</head>

<body>
  <!-- Custom Titlebar -->
  <div id="titlebar" data-tauri-drag-region>
    <span id="titlebar-title" data-tauri-drag-region>m3u Player</span>
    <div id="titlebar-controls">
      <button id="titlebar-minimize" class="titlebar-btn" title="Minimize">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M5 12h14" />
        </svg>
      </button>
      <button id="titlebar-maximize" class="titlebar-btn" title="Maximize">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="5" y="5" width="14" height="14" rx="1" />
        </svg>
      </button>
      <button id="titlebar-close" class="titlebar-btn titlebar-close" title="Close">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <main id="app">
    <section id="player-section">
      <div id="player-wrapper">
        <video id="video-player" autoplay controls></video>
        <div id="player-overlay" class="visible">
          <svg viewBox="0 0 24 24" fill="currentColor" width="64" height="64">
            <path d="M8 5v14l11-7z" />
          </svg>
          <p>Open Channels to get started</p>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer Bar -->
  <footer id="footer">
    <div id="footer-left">
      <span id="now-playing-dot" class="hidden"></span>
      <span id="now-playing-name">No channel selected</span>
      <button id="stop-btn" class="hidden" title="Stop playback">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
          stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <div id="footer-center">
      <button id="channels-btn" title="Show channels">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round">
          <rect x="2" y="3" width="20" height="18" rx="2" />
          <path d="M8 7h8M8 12h8M8 17h4" />
        </svg>
        <span>Channels</span>
      </button>
      <button id="sources-btn" title="Show sources">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round">
          <circle cx="12" cy="12" r="3" />
          <path
            d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M4.93 19.07l1.41-1.41m11.32-11.32l1.41-1.41" />
        </svg>
        <span>Sources</span>
      </button>
    </div>

    <!-- Credits Trigger -->
    <div id="credits-trigger">
      <button id="credits-star" title="Credits & Shoutouts" aria-label="Credits">‚ú¶</button>
    </div>
  </footer>

  <!-- Credits Modal -->
  <div id="credits-modal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-container">
      <div class="modal-header">
        <div class="modal-title-group">
          <h2>Community Shoutouts</h2>
          <p>m3u Player works best with these amazing projects</p>
        </div>
        <button id="credits-close" class="modal-close">&times;</button>
      </div>

      <div class="modal-content">
        <div class="credits-grid">
          <!-- Channels DVR -->
          <a href="https://getchannels.com" class="credit-card" target="_blank">
            <div class="card-icon">üì∫</div>
            <div class="card-body">
              <h3>Channels DVR</h3>
              <p>The ultimate personal media server for live TV.</p>
              <span class="card-link">getchannels.com</span>
            </div>
          </a>

          <!-- Plex for Channels -->
          <a href="https://github.com/jgomez177/plex-for-channels" class="credit-card" target="_blank">
            <div class="card-icon">üìΩÔ∏è</div>
            <div class="card-body">
              <h3>Plex for Channels</h3>
              <p>by <strong>jgomez177</strong> ‚Äî Bridge Plex to Channels DVR.</p>
              <span class="card-link">github.com/jgomez177</span>
            </div>
          </a>

          <!-- Pluto for Channels -->
          <a href="https://github.com/jgomez177/pluto-for-channels" class="credit-card" target="_blank">
            <div class="card-icon">ü™ê</div>
            <div class="card-body">
              <h3>Pluto for Channels</h3>
              <p>by <strong>jgomez177</strong> ‚Äî Watch Pluto TV in your favorite player.</p>
              <span class="card-link">github.com/jgomez177</span>
            </div>
          </a>

          <!-- Tubi for Channels -->
          <a href="https://github.com/jgomez177/tubi-for-channels" class="credit-card" target="_blank">
            <div class="card-icon">üéûÔ∏è</div>
            <div class="card-body">
              <h3>Tubi for Channels</h3>
              <p>by <strong>jgomez177</strong> ‚Äî Stream Tubi content anywhere.</p>
              <span class="card-link">github.com/jgomez177</span>
            </div>
          </a>

          <!-- PrismCast -->
          <a href="https://github.com/hjdhjd/prismcast" class="credit-card" target="_blank">
            <div class="card-icon">üåà</div>
            <div class="card-body">
              <h3>PrismCast</h3>
              <p>by <strong>hjdhjd</strong> ‚Äî Premium streaming engine.</p>
              <span class="card-link">github.com/hjdhjd</span>
            </div>
          </a>
        </div>
      </div>

      <div class="modal-footer">
        <p>mike_here - <span class="repo-link">https://github.com/kolns/m3u-player</span></p>
      </div>
    </div>
  </div>

  <!-- Drawer Backdrop (shared) -->
  <div id="drawer-backdrop" class="hidden"></div>

  <!-- Channel Drawer -->
  <aside id="channel-drawer" class="drawer">
    <div class="drawer-header">
      <h3>My Channels</h3>
      <button class="drawer-close" title="Close">√ó</button>
    </div>
    <div id="tab-channels" class="tab-content">
      <div id="channel-grid"></div>
      <p id="no-channels" class="empty-state">
        Add channels from the <strong>Sources</strong> menu to get started
      </p>
    </div>
  </aside>

  <!-- Settings Drawer -->
  <aside id="settings-drawer" class="drawer">
    <div class="drawer-header">
      <div id="settings-header-content">
        <h3>Sources</h3>
        <!-- Browse Header (nested inside settings when browsing) -->
        <div id="browse-header" class="hidden">
          <button id="browse-back" title="Back to sources">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
          </button>
          <div id="browse-title">
            <h3 id="browse-source-name"></h3>
            <span id="browse-count"></span>
          </div>
          <button id="browse-add-all" class="text-btn">Add All</button>
        </div>
      </div>
      <button class="drawer-close" title="Close">√ó</button>
    </div>

    <!-- Tab: Manage Sources -->
    <div id="tab-sources" class="tab-content">
      <!-- Add Source Form -->
      <div id="add-source-form">
        <input type="text" id="source-name" placeholder="Source name (e.g. Channels DVR)" autocomplete="off" />
        <input type="url" id="source-url" placeholder="M3U playlist URL" autocomplete="off" spellcheck="false" />
        <button id="add-source-btn" type="button">Add Source</button>
      </div>
      <p id="source-error" class="error-msg hidden"></p>
      <div id="source-list"></div>
      <p id="no-sources" class="empty-state">
        No sources added yet. Add an M3U playlist URL above.
      </p>
    </div>

    <!-- Tab: Browse Source -->
    <div id="tab-browse" class="tab-content hidden">
      <div id="browse-grid"></div>
      <div id="browse-loading" class="empty-state hidden">Loading channels...</div>
    </div>
  </aside>
</body>

</html>